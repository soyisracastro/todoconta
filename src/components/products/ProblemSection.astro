---
interface Problem {
  icon: string;
  title: string;
  description: string;
}

export interface Props {
  badge: string;
  title: string;
  highlightedWord?: string | undefined;
  descriptions: string[];
  problems: Problem[];
}

const { badge, title, highlightedWord, descriptions, problems } = Astro.props;

// Split title to insert highlighted word if provided
let titleParts = [title];
if (highlightedWord && title.includes(highlightedWord)) {
  titleParts = title.split(highlightedWord);
}
---

<section class="bg-white dark:bg-background-dark py-16 md:py-24 font-display">
  <div class="max-w-[1280px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="problem-grid-layout gap-12 lg:gap-16 items-center">
      <!-- Left Column: Content -->
      <div class="problem-content-col flex flex-col gap-6">
        <div class="flex items-center gap-2 mb-2">
          <span
            class="bg-gray-100 dark:bg-slate-800 text-navy-blue dark:text-slate-200 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider"
          >
            {badge}
          </span>
        </div>

        <h2
          class="text-navy-blue dark:text-white tracking-tight text-4xl md:text-5xl lg:text-6xl font-black leading-tight problem-title m-0"
        >
          {
            highlightedWord && title.includes(highlightedWord) ? (
              <>
                {titleParts[0]}
                <span class="relative inline-block text-primary">
                  {highlightedWord}
                  <svg
                    class="absolute w-full h-3 -bottom-1 left-0 text-primary opacity-40"
                    preserveAspectRatio="none"
                    viewBox="0 0 100 10"
                  >
                    <path
                      d="M0 5 Q 50 10 100 5"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="8"
                    />
                  </svg>
                </span>
                {titleParts[1]}
              </>
            ) : (
              title
            )
          }
        </h2>

        {
          descriptions.map((desc, index) => (
            <p
              class={`text-slate-600 dark:text-slate-300 ${index === 0 ? 'text-lg md:text-xl font-normal' : 'text-base font-medium border-l-4 border-primary pl-4'} leading-relaxed max-w-[650px]`}
            >
              {desc}
            </p>
          ))
        }
      </div>

      <!-- Right Column: Problem Cards -->
      <div class="problem-cards-col flex flex-col gap-4">
        {
          problems.map(problem => (
            <div class="group flex gap-5 rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 p-6 shadow-sm hover:shadow-md transition-all duration-300 hover:border-primary/50">
              <div class="shrink-0 flex items-center justify-center w-12 h-12 rounded-lg bg-green-50 dark:bg-green-900/20 text-primary group-hover:bg-primary group-hover:text-white transition-colors duration-300">
                <span class="material-symbols-outlined text-[28px]">
                  {problem.icon}
                </span>
              </div>
              <div class="flex flex-col gap-1">
                <h3 class="text-navy-blue dark:text-white text-lg font-bold leading-tight m-0">
                  {problem.title}
                </h3>
                <p class="text-slate-500 dark:text-slate-400 text-sm font-normal leading-normal">
                  {problem.description}
                </p>
              </div>
            </div>
          ))
        }
      </div>
    </div>

    <!-- Footer: Scroll Indicator -->
    <div class="w-full flex justify-center mt-16 md:mt-24">
      <div class="flex flex-col items-center gap-2 opacity-50 animate-bounce">
        <span class="text-sm font-medium text-slate-500 dark:text-slate-400"
          >Existe una mejor forma</span
        >
        <span class="material-symbols-outlined text-primary"
          >keyboard_double_arrow_down</span
        >
      </div>
    </div>
  </div>
</section>

<style>
  .problem-grid-layout {
    display: grid;
    grid-template-columns: 1fr;
    width: 100%;
  }

  .problem-title {
    font-size: clamp(2rem, 5vw, 3.75rem);
    line-height: 1.1;
  }

  @media (min-width: 1024px) {
    .problem-grid-layout {
      grid-template-columns: repeat(12, 1fr);
    }
    .problem-content-col {
      grid-column: span 7 / span 7;
    }
    .problem-cards-col {
      grid-column: span 5 / span 5;
    }
  }
</style>
